{
  "name": "hr_email_assistant",
  "nodes": [
    {
      "parameters": {
        "pollTimes": {
          "item": [
            {
              "mode": "everyMinute"
            }
          ]
        },
        "simple": false,
        "filters": {
          "readStatus": "unread"
        },
        "options": {
          "downloadAttachments": true
        }
      },
      "type": "n8n-nodes-base.gmailTrigger",
      "typeVersion": 1.2,
      "position": [
        160,
        580
      ],
      "id": "f1dfa104-b145-415c-acb0-6d9d3de23f88",
      "name": "Gmail Trigger",
      "credentials": {
        "gmailOAuth2": {
          "id": "uF0jtzL8iRYG5pW8",
          "name": "Gmail account Clarium"
        }
      }
    },
    {
      "parameters": {
        "inputText": "={{ $json.subject }}\n{{ $json.text }}\n{{ $json.chatInput }}",
        "categories": {
          "categories": [
            {
              "category": "Postulation",
              "description": "=Le texte contiens une intention de dépot de candidature ou de postuler."
            },
            {
              "category": "Non Posutlation",
              "description": "=Le texte ne contiens pas une intention de depot de candidature ou de postuler."
            }
          ]
        },
        "options": {
          "systemPromptTemplate": "=Tu es un agent d'analyse de texte chargé de déterminer si le contenu fourni correspond à une **postulation à une offre d’emploi**.\n\nTa tâche est simple : analyser le texte dans son ensemble, repérer des **indicateurs explicites** ou **formulations courantes** liées à une démarche de candidature, puis classer le texte dans l'une des deux catégories suivantes :\n\n---\n\n### 1. Postulation\nLe texte est une postulation **si au moins une de ces conditions est remplie** :\n- Il contient des phrases telles que :\n  - \"Je souhaite postuler\"\n  - \"Je vous adresse ma candidature\"\n  - \"Veuillez trouver mon CV\"\n  - \"Je me permets de candidater\"\n  - \"Je postule pour le poste de...\"\n  - \"Je suis intéressé(e) par le poste de...\"\n  - \"En réponse à votre offre d’emploi\"\n- Il contient un **ton formel**, **adressé à un recruteur** ou à une entreprise.\n- Il mentionne des éléments typiques d’une candidature :\n  - Le **poste visé**\n  - Le **CV** ou la **lettre de motivation**\n  - Des **compétences ou expériences professionnelles**\n  - Une **motivation ou disponibilité**\n\n---\n\n### 2. Non-postulation\nLe texte **n’est pas une postulation** s’il s’agit :\n- D’une simple demande d’informations\n- D’un message sans intention claire de postuler\n- D’un échange informel ou sans rapport avec un emploi\n- D’un contenu promotionnel, personnel, ou général\n\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1,
      "position": [
        640,
        600
      ],
      "id": "abdfb844-2ab2-4e43-a876-385b3b6a19ab",
      "name": "Text Classifier"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        1060,
        700
      ],
      "id": "5f78bfad-4009-4254-ac17-fdcdc72f2e35",
      "name": "No Operation, do nothing"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "f33fdcc7-8cbd-4407-a99a-6f43b2296be2",
                    "leftValue": "attachment_0",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "exists",
                      "singleValue": true
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {
          "allMatchingOutputs": true
        }
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1060,
        500
      ],
      "id": "217be72b-5b34-473d-baf3-11f1ef514352",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "pdf",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1920,
        500
      ],
      "id": "88088657-5839-4eaf-ba9f-ba4c2695a552",
      "name": "Extract from File"
    },
    {
      "parameters": {
        "inputDataFieldName": "=attachment_0",
        "name": "={{ $('Gmail Trigger').item.json.from.value[0].address }}",
        "driveId": {
          "__rl": true,
          "mode": "list",
          "value": "My Drive"
        },
        "folderId": {
          "__rl": true,
          "value": "1GK5a8OICla88RVVsVhGzDv1OwVGq9qeF",
          "mode": "list",
          "cachedResultName": "profils",
          "cachedResultUrl": "https://drive.google.com/drive/folders/1GK5a8OICla88RVVsVhGzDv1OwVGq9qeF"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1320,
        500
      ],
      "id": "9b0382e5-dac8-4710-b644-f538444cc481",
      "name": "upload",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "P89NuqaEffChETXb",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "operation": "share",
        "fileId": {
          "__rl": true,
          "value": "={{ $json.id }}",
          "mode": "id"
        },
        "permissionsUi": {
          "permissionsValues": {
            "role": "writer",
            "type": "anyone"
          }
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1520,
        500
      ],
      "id": "0db7490d-53f8-4c23-98e0-eb3c94f3bf8c",
      "name": "share",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "P89NuqaEffChETXb",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "text": "=Email object: {{ $('Gmail Trigger').item.json.subject }}\n\nCurriculum: \n{{ $('Extract from File').item.json.text }}",
        "schemaType": "fromJson",
        "jsonSchemaExample": "{\n  \"name\": \"Jean Dupont\",\n  \"phone_number\": \"+33 6 12 34 56 78\",\n  \"email\": \"jean.dupont@email.com\",\n  \"profile_summary\": \"Software developer with 5 years of experience in backend development in Java environments. Trained in computer science with AWS and Scrum certifications, he has    worked on complex projects using Agile methodology for major tech companies.\",\n  \"desired_position\": \"Java Backend Developer\",\n  \"education\": [\n    {\n      \"title\": \"Master in Computer Science\",\n      \"specialization\": \"Software Development\",\n      \"institution\": \"University of Paris\"\n    },\n    {\n      \"title\": \"Bachelor in Mathematics\",\n      \"specialization\": \"Computer Science\",\n      \"institution\": \"University of Lyon\"\n    }\n  ],\n  \"skills\": [\n    \"Java\",\n    \"Spring Boot\",\n    \"Docker\",\n    \"Git\",\n    \"Agile Methods\"\n  ],\n  \"languages\":[\n    \"english\",\n    \"french\"\n  ],\n  \"certifications\": [\n    \"AWS Certified Solutions Architect\",\n    \"Scrum Master PSM I\"\n  ],\n  \"work_experiences\": [\n    {\n      \"position\": \"Backend Developer\",\n      \"company\": \"Capgemini\",\n      \"duration\": \"3 years\",\n      \"missions\": \"Developed REST APIs in Java, continuous integration, participation in Agile ceremonies.\"\n    },\n    {\n      \"position\": \"Software Engineer\",\n      \"company\": \"Sopra Steria\",\n      \"duration\": \"2 years\",\n      \"missions\": \"Java application maintenance, incident management, collaboration with DevOps teams.\"\n    }\n  ]\n}\n",
        "options": {
          "systemPromptTemplate": "=You are an HR assistant specialized in recruitment and CV analysis. Your role is to review the content of a resume and the application objective in order to extract and assess the key information from a candidate's profile.\nYour goal is to facilitate the selection of relevant applications for a given position by objectively evaluating the alignment between the candidate's profile and the desired role.\n\n## Tasks to Perform\nFor each application, extract and generate the following elements based on the content of the CV and the objective of the application:\n- Full Name  \n- Phone Number  \n- Email Address (in lowercase)\n- Degrees: Mention the titles, majors, and institutions if available.  \n- Skills: List technical, functional, or soft skills.  \n- Certifications: List any obtained certifications. If none are available, write \"None\".  \n- Work Experience: Detail the main experiences, including job title, company, duration, and key responsibilities.  \n- Profile Summary: Write a clear paragraph of 2 to 3 sentences summarizing the candidate’s professional background, linking their skills, education, certifications, and experience with the targeted position.  \n- Desired Position: Infer this information from the subject line of the application email.(Translate it in english) \n- Relevance Score (out of 10): Evaluate how well the candidate's profile matches the targeted position.  \n- Score Explanation: Objectively justify this score by explaining the strengths and any gaps (e.g., skill mismatch or lack of specific experience).\n\n## Presentation Guidelines\n- Be structured, clear, and professional.  \n- Begin each sentence with a capital letter.  \n- Use capital letters for proper nouns (places, degrees, companies, etc.).  \n- If a piece of information is not available, write \"None\".\n- Please always write in english\n- Always output the email in lowercase.\n"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.informationExtractor",
      "typeVersion": 1,
      "position": [
        2200,
        420
      ],
      "id": "f0e13dbb-2804-4690-b942-4fd7398567d9",
      "name": "Extracteur"
    },
    {
      "parameters": {
        "operation": "markAsRead",
        "messageId": "={{ $('Gmail Trigger').item.json.id }}"
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        4620,
        440
      ],
      "id": "8f08652a-f7f2-4235-8840-389f41b440b5",
      "name": "mark as read",
      "webhookId": "7ab59325-0b92-449e-a4ef-ac90a7b7c07a",
      "credentials": {
        "gmailOAuth2": {
          "id": "uF0jtzL8iRYG5pW8",
          "name": "Gmail account Clarium"
        }
      }
    },
    {
      "parameters": {
        "operation": "addLabels",
        "messageId": "={{ $('Gmail Trigger').item.json.id }}",
        "labelIds": [
          "Label_1028932397184549389"
        ]
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        4840,
        440
      ],
      "id": "96eb4ba4-db6b-4f87-a7e5-d21a9843c22e",
      "name": "move email to folder",
      "webhookId": "97a3bb04-1078-4acb-9b64-b3f500d37265",
      "credentials": {
        "gmailOAuth2": {
          "id": "uF0jtzL8iRYG5pW8",
          "name": "Gmail account Clarium"
        }
      }
    },
    {
      "parameters": {
        "operation": "removeLabels",
        "messageId": "={{ $('Gmail Trigger').item.json.id }}",
        "labelIds": [
          "INBOX"
        ]
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        5060,
        440
      ],
      "id": "e34b5b4c-6616-4678-99d7-80995f3e4298",
      "name": "remove from inbox",
      "webhookId": "108b9e10-ebe7-4097-b7a6-8e3bbe904e94",
      "credentials": {
        "gmailOAuth2": {
          "id": "uF0jtzL8iRYG5pW8",
          "name": "Gmail account Clarium"
        }
      }
    },
    {
      "parameters": {
        "model": "google/gemini-2.0-flash-exp:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2280,
        640
      ],
      "id": "d67e543f-c265-4c3c-8b22-4565cce56a49",
      "name": "OpenRouter Chat Model",
      "credentials": {
        "openRouterApi": {
          "id": "CpvKgTTzwSZqH1Zw",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "schemaType": "manual",
        "inputSchema": "{\n  \"type\": \"object\",\n  \"properties\": {\n    \"relevance_score\": {\n      \"type\": \"integer\",\n      \"minimum\": 0,\n      \"maximum\": 10\n    },\n    \"application_status\": {\n      \"type\": \"string\",\n      \"enum\": [\"Relevant\", \"To Be Reviewed\", \"Rejectable\"]\n    },\n    \"score_justification\": {\n      \"type\": \"string\"\n    }\n  },\n  \"required\": [\"relevance_score\", \"application_status\", \"score_justification\"]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        3060,
        660
      ],
      "id": "1b40430e-1bb6-4835-97c0-419e6aed54ee",
      "name": "Structured Output Parser"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=## Desired Position \n{{ $json.Desired_position }}\n\n## Applicant Informations\n\nWork Experience:  \n{{ $json.Work_experience }}\n\nEducation:  \n{{ $json.Education }}\n\nTechnical Skills:  \n{{ $json.Skills }}\n\nCertifications:  \n{{ $json.Certifications }}",
        "hasOutputParser": true,
        "messages": {
          "messageValues": [
            {
              "message": "=You are an expert HR evaluation agent. Your role is to analyze a candidate’s suitability for a specific position based on their CV and the subject line of their application.\n\nYour goal is to determine whether the profile is relevant for the targeted role by assigning an overall score out of 10, based on the candidate’s work experience, education, technical skills, and certifications. You must also objectively explain the reasoning behind your score.\n\n## Task:\n\nAssess whether the candidate has the real and concrete qualifications needed for the desired position (provided in the subject line of the application email).\n\nFollow each step below carefully to assign a final score.\n\n### Scoring by category:\n\n1. Work Experience (0 to 4 points)  \n- 0: No experience related to the position  \n- 1: Indirect or unrelated experience  \n- 2: Relevant but limited experience (6 months to 1 year)  \n- 3: Solid experience (1 to 2 years in similar roles)  \n- 4: Strong experience (> 3 years in similar roles)  \n\n2. Education (0 to 2 points)  \n- 0: No degree related to the position  \n- 1: Degree somewhat related to the position  \n- 2: Specialized degree directly aligned with the target role  \n\n3. Technical Skills (0 to 3 points)  \n- 0: No relevant technical skills for the role  \n- 1: Basic or self-taught skills that could be useful  \n- 2: Useful skills but lacking depth or experience  \n- 3: Clear mastery of the tools/technologies required for the role  \n\n4. Certifications (0 to 1 point)  \n- 0: No relevant certifications  \n- 1: At least one recognized certification, whether directly related or not  \n- 2: One or more certified qualifications directly linked to the role  \n\n### Final Score Calculation:\n\nAfter scoring each category, sum the points to produce a final score out of 10. The score must be a whole number and no more than 10. Also provide a clear, concise explanation of the score (max. 3 sentences), mentioning the candidate’s strengths and weaknesses.\n\n### Determining Candidate Status:\n\nBased on the score, assign one of the following statuses:  \n- Relevant: score ≥ 6  \n- To Be Reviewed: score between 3 and 5  \n- To Be Rejected: score < 3  \n\n## Expected Output:\n\n1. Final relevance score out of 10  \n2. Application Status: Relevant / To Be Reviewed / Rejectable  \n3. Justified explanation of the score  \n\n## Important Rules:\n\n- Use structured sentences with capital letters at the beginning.  \n- If a piece of information is missing, write \"None\".  \n- Conduct the analysis with rigor, impartiality, and professionalism.\n- application_status can only take one of these 3 outputs: (\"Relevant\", \"To Be Reviewed\", \"Rejectable\")\n- Always repsonse in english."
            }
          ]
        }
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.6,
      "position": [
        2860,
        420
      ],
      "id": "4e4a7481-9589-466b-a254-910a16f9fd2a",
      "name": "Evaluation"
    },
    {
      "parameters": {
        "content": "# Trigger\n\nThis node is used to get incoming emails from **GMAIL**.",
        "height": 1460,
        "width": 500,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        20,
        -80
      ],
      "id": "986bdb3b-dacb-4ed5-a436-43c7baddccd1",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "## Email Filter\n\nDetermine if the email is an application or not.",
        "height": 1460,
        "width": 420,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        540,
        -80
      ],
      "id": "2826a514-4eef-4fcf-b976-92f58e6a0a0b",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "content": "## Check attachement\n\nCheck if there is an attachement in the email.",
        "height": 1460,
        "width": 260,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        980,
        -80
      ],
      "id": "13f093fe-b798-4270-9a2c-74953f50f1c7",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## Upload to Drive\n\nUpload, Share the curriculum to Google Drive. Then extract the data from the PDF To process it with AI.",
        "height": 1460,
        "width": 860,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1260,
        -80
      ],
      "id": "fa314162-6aea-4f82-adec-258f60b0249d",
      "name": "Sticky Note3"
    },
    {
      "parameters": {
        "operation": "download",
        "fileId": {
          "__rl": true,
          "value": "={{ $('upload').item.json.id }}",
          "mode": "id"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleDrive",
      "typeVersion": 3,
      "position": [
        1720,
        500
      ],
      "id": "d9b983b1-0120-4eb0-a772-c2580faca43d",
      "name": "Download",
      "credentials": {
        "googleDriveOAuth2Api": {
          "id": "P89NuqaEffChETXb",
          "name": "Google Drive account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Extrcator\n\nWe're using AI to scrape all the informations of an application from his cv.",
        "height": 1460,
        "width": 500,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2140,
        -80
      ],
      "id": "79326193-3e6f-4064-9d60-0f4671d4125a",
      "name": "Sticky Note4"
    },
    {
      "parameters": {
        "content": "## Append In Supabase without matching post",
        "height": 680,
        "width": 480,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4020,
        -80
      ],
      "id": "d9925f2e-ad7e-45da-9d69-9d7fba945594",
      "name": "Sticky Note6"
    },
    {
      "parameters": {
        "content": "## Email Update",
        "height": 1460,
        "width": 760,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4520,
        -80
      ],
      "id": "e321d655-1b2a-44fc-9f7f-feb35af6a44f",
      "name": "Sticky Note7"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "df6b3ba6-5c18-4f5d-b86f-43aa4a70c21e",
              "name": "Education",
              "value": "={{ $json.output.education }}",
              "type": "string"
            },
            {
              "id": "5ff3354c-81f7-4184-befb-6a414973ad77",
              "name": "Work_experience",
              "value": "={{ $json.output.work_experiences }}",
              "type": "string"
            },
            {
              "id": "9acbb540-743d-48d0-8e6c-a6fb7491e9fa",
              "name": "Certifications",
              "value": "={{ $json.output.certifications }}",
              "type": "string"
            },
            {
              "id": "b5435235-ca9c-4fa1-931b-468c7d2b44ef",
              "name": "Desired_position",
              "value": "={{ $json.output.desired_position }}",
              "type": "string"
            },
            {
              "id": "5ae6f4d8-a421-4c5f-ad3d-aa9cec55c2dc",
              "name": "Skills",
              "value": "={{ $json.output.skills }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2500,
        420
      ],
      "id": "f7145775-d595-4dc9-9163-766d1a1c8cfd",
      "name": "Turn to String"
    },
    {
      "parameters": {
        "content": "## Append In Supabase with matching post ID",
        "height": 760,
        "width": 480,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4020,
        620
      ],
      "id": "7123b4d9-e623-4758-b99d-d1b8e3c0b3fa",
      "name": "Sticky Note8"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "6e4124e1-e4a1-45bb-b2a4-c4ae20fefa82",
              "leftValue": "={{ $json.output.id }}",
              "rightValue": "",
              "operator": {
                "type": "string",
                "operation": "empty",
                "singleValue": true
              }
            },
            {
              "id": "f8f6c835-a879-4443-8fa8-a4862fa31b92",
              "leftValue": "={{ $json.output.id }}",
              "rightValue": "null",
              "operator": {
                "type": "string",
                "operation": "equals"
              }
            },
            {
              "id": "1bdbac7a-ba4f-4b59-95d9-84183200317a",
              "leftValue": "={{ $json.output.id }}",
              "rightValue": "NULL",
              "operator": {
                "type": "string",
                "operation": "equals",
                "name": "filter.operator.equals"
              }
            }
          ],
          "combinator": "or"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        3740,
        420
      ],
      "id": "00a0a36d-e4a9-4a3a-8469-13f577120299",
      "name": "If"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n\t\"title\": \"business analyst\",\n\t\"id\": \"8797668696\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        3800,
        880
      ],
      "id": "e8d91b64-16d2-4a43-b429-3c686ffa1134",
      "name": "Structured Output Parser1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=## Desired Position \n{{ $('Turn to String').item.json.Desired_position }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are an hr assistant and your task is to match applicant's desired post with already existing posts in the supabase dataset.\nYou have access to the posts database on Supabase using the tool named 'get posts'. \nThis tool returns all currently open posts from the database, each with its `id`, `title`.\n\nFollow these intructions and always execute them in order to complete you task:\n1. Use the supabase tool to retrieve all the posts by using this query : (select=title,id). You will get a jsonn response that look like this : \n''''\n{\n  \"response\": [\n    {\n      \"title\": \"Web development\",\n      \"id\": \"7f791f5c-850b-4d29-a0b3-58996df33536\"\n    },\n    {\n      \"title\": \"Automation Expert\",\n      \"id\": \"57529622-105a-4670-8098-be26d4827517\"\n    }\n  ]\n}\n''''\nTitle is the post title and id is the generated id from the supabase dataset.\n2. After you get all the available posts, you will look for all the titles from the posts database and find the best match for the applicant desired post.\n3. After you found the best  matching post.Output only:\n- The `title` of the best matching post.\n- The `id` of that post.\n\n## Important rules:\n- Always follow the instructions and execute them in order. Do not do anything else outside what you have to do.\n- Always return null if you did not found any posts."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.9,
      "position": [
        3340,
        420
      ],
      "id": "b179a150-76b5-467e-ac37-6a315f177563",
      "name": "Post Matcher"
    },
    {
      "parameters": {
        "tableId": "candidates",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "name",
              "fieldValue": "={{ $('Extracteur').item.json.output.name }}"
            },
            {
              "fieldId": "email",
              "fieldValue": "={{ $('Extracteur').item.json.output.email }}"
            },
            {
              "fieldId": "phone",
              "fieldValue": "={{ $('Extracteur').item.json.output.phone_number.replaceAll('+', \"\") }}"
            },
            {
              "fieldId": "experiences",
              "fieldValue": "={{ $('Extracteur').item.json.output.work_experiences }}"
            },
            {
              "fieldId": "degrees",
              "fieldValue": "={{ $('Extracteur').item.json.output.education }}"
            },
            {
              "fieldId": "skills",
              "fieldValue": "={{ $('Extracteur').item.json.output.skills }}"
            },
            {
              "fieldId": "certifications",
              "fieldValue": "={{ $('Extracteur').item.json.output.certifications }}"
            },
            {
              "fieldId": "profile_summary",
              "fieldValue": "={{ $('Extracteur').item.json.output.profile_summary }}"
            },
            {
              "fieldId": "desired_position",
              "fieldValue": "={{ $('Extracteur').item.json.output.desired_position }}"
            },
            {
              "fieldId": "relevance_score",
              "fieldValue": "={{ $('Evaluation').item.json.output.Relevance_Score }}"
            },
            {
              "fieldId": "score_justification",
              "fieldValue": "={{ $('Evaluation').item.json.output.Score_Justification }}"
            },
            {
              "fieldId": "application_status",
              "fieldValue": "={{ $('Evaluation').item.json.output['Application_Status'] }}"
            },
            {
              "fieldId": "cv_url",
              "fieldValue": "={{ $('upload').item.json.webViewLink }}"
            },
            {
              "fieldId": "post_id",
              "fieldValue": "={{ $('Post Matcher').item.json.output.id }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        4200,
        980
      ],
      "id": "6d4e47fe-1b08-4ecd-b1f7-a8b2bacf3a12",
      "name": "Create Candidate With post_id",
      "credentials": {
        "supabaseApi": {
          "id": "4DjZUAZLVswBTR7j",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "tableId": "candidates",
        "fieldsUi": {
          "fieldValues": [
            {
              "fieldId": "name",
              "fieldValue": "={{ $('Extracteur').item.json.output.name }}"
            },
            {
              "fieldId": "email",
              "fieldValue": "={{ $('Extracteur').item.json.output.email }}"
            },
            {
              "fieldId": "phone",
              "fieldValue": "={{ $('Extracteur').item.json.output.phone_number.replaceAll('+', \"\") }}"
            },
            {
              "fieldId": "experiences",
              "fieldValue": "={{ $('Extracteur').item.json.output.work_experiences }}"
            },
            {
              "fieldId": "degrees",
              "fieldValue": "={{ $('Extracteur').item.json.output.education }}"
            },
            {
              "fieldId": "skills",
              "fieldValue": "={{ $('Extracteur').item.json.output.skills }}"
            },
            {
              "fieldId": "certifications",
              "fieldValue": "={{ $('Extracteur').item.json.output.certifications }}"
            },
            {
              "fieldId": "profile_summary",
              "fieldValue": "={{ $('Extracteur').item.json.output.profile_summary }}"
            },
            {
              "fieldId": "desired_position",
              "fieldValue": "={{ $('Extracteur').item.json.output.desired_position }}"
            },
            {
              "fieldId": "relevance_score",
              "fieldValue": "={{ $('Evaluation').item.json.output.Relevance_Score }}"
            },
            {
              "fieldId": "score_justification",
              "fieldValue": "={{ $('Evaluation').item.json.output.Score_Justification }}"
            },
            {
              "fieldId": "application_status",
              "fieldValue": "={{ $('Evaluation').item.json.output['Application_Status'] }}"
            },
            {
              "fieldId": "cv_url",
              "fieldValue": "={{ $('upload').item.json.webViewLink }}"
            }
          ]
        }
      },
      "type": "n8n-nodes-base.supabase",
      "typeVersion": 1,
      "position": [
        4200,
        120
      ],
      "id": "c3a527b0-ad48-4933-a82b-ea02d0e747ee",
      "name": "Create Candidate no ID",
      "credentials": {
        "supabaseApi": {
          "id": "4DjZUAZLVswBTR7j",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Use this tool to get all available posts from the supabase posts database.\nYou will need to provide a PostREST filter query. \nThe PostREST filter query = \"select=title,id\"",
        "operation": "getAll",
        "tableId": "posts",
        "returnAll": true,
        "filterType": "string",
        "filterString": "={{ $fromAI('PostREST_filter_query', `this is the PostREST filter query you will need to fill this field with his default value`, 'string', \"select=title,id\") }}"
      },
      "type": "n8n-nodes-base.supabaseTool",
      "typeVersion": 1,
      "position": [
        3440,
        740
      ],
      "id": "4ad38810-8f4b-431c-8a95-2cc857fcc726",
      "name": "Get Posts",
      "credentials": {
        "supabaseApi": {
          "id": "4DjZUAZLVswBTR7j",
          "name": "Supabase account"
        }
      }
    },
    {
      "parameters": {
        "content": "## Look for matching posts for the candidate \n\n- If the applicant desired post match a post in the database we will add post_id to the record.",
        "height": 1460,
        "width": 760,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        3240,
        -80
      ],
      "id": "34c0574f-ae16-4299-a4cb-979b7b668f23",
      "name": "Sticky Note5"
    },
    {
      "parameters": {
        "content": "## Evaluator\n\nGives a score to the application based on exps, skills, certifications..",
        "height": 1460,
        "width": 560,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2660,
        -80
      ],
      "id": "395212ba-bb4c-433e-b920-1c6717054e6f",
      "name": "Sticky Note9"
    },
    {
      "parameters": {
        "model": "qwen/qwq-32b:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2880,
        640
      ],
      "id": "41907467-9772-40de-9f1f-3d4781722227",
      "name": "qwen",
      "credentials": {
        "openRouterApi": {
          "id": "CpvKgTTzwSZqH1Zw",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash-001",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        740,
        820
      ],
      "id": "aec57597-bea9-41dc-8554-88d8650c28e4",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "quBg0Lp5soBXAEqK",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "model": "deepseek/deepseek-chat-v3-0324:free",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3300,
        740
      ],
      "id": "ceab80f2-d9ab-4823-be64-28638cb953f4",
      "name": "OpenRouter Chat Model1",
      "credentials": {
        "openRouterApi": {
          "id": "CpvKgTTzwSZqH1Zw",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserAutofixing",
      "typeVersion": 1,
      "position": [
        3620,
        640
      ],
      "id": "2e2bb462-2b85-4f34-8fa7-452fc1769edf",
      "name": "Auto-fixing Output Parser"
    },
    {
      "parameters": {
        "modelName": "models/gemini-2.0-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        3620,
        880
      ],
      "id": "67976a61-41db-431b-b24d-1e48d38f5331",
      "name": "Google Gemini Chat Model1",
      "credentials": {
        "googlePalmApi": {
          "id": "quBg0Lp5soBXAEqK",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    }
  ],
  "pinData": {},
  "connections": {
    "Gmail Trigger": {
      "main": [
        [
          {
            "node": "Text Classifier",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Text Classifier": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Operation, do nothing",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "upload",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract from File": {
      "main": [
        [
          {
            "node": "Extracteur",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "upload": {
      "main": [
        [
          {
            "node": "share",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "share": {
      "main": [
        [
          {
            "node": "Download",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extracteur": {
      "main": [
        [
          {
            "node": "Turn to String",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "mark as read": {
      "main": [
        [
          {
            "node": "move email to folder",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "move email to folder": {
      "main": [
        [
          {
            "node": "remove from inbox",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Extracteur",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Evaluation",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Evaluation": {
      "main": [
        [
          {
            "node": "Post Matcher",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Download": {
      "main": [
        [
          {
            "node": "Extract from File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Turn to String": {
      "main": [
        [
          {
            "node": "Evaluation",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Create Candidate no ID",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Create Candidate With post_id",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Structured Output Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Auto-fixing Output Parser",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Post Matcher": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Candidate With post_id": {
      "main": [
        [
          {
            "node": "mark as read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Candidate no ID": {
      "main": [
        [
          {
            "node": "mark as read",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get Posts": {
      "ai_tool": [
        [
          {
            "node": "Post Matcher",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "qwen": {
      "ai_languageModel": [
        [
          {
            "node": "Evaluation",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Text Classifier",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "OpenRouter Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Post Matcher",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Auto-fixing Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Post Matcher",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model1": {
      "ai_languageModel": [
        [
          {
            "node": "Auto-fixing Output Parser",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": false,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "88cc8f2b-f7a5-4012-8b55-1750a75803db",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "1f3bf0740e86805879ff06102b8c465db40713bc059e5e6e6903caae1305dc76"
  },
  "id": "CRrXtjdhxkK8PW8g",
  "tags": []
}